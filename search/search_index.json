{"config":{"lang":["en","de"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Welcome to the Tuya Water Quality Monitor","text":"<p>This project provides a complete, self-hosted solution for monitoring water quality using common Tuya-compatible devices. It's designed to be robust, scalable, and easy to use, giving you full ownership and control over your data without relying on third-party cloud services.</p> <p></p>"},{"location":"#the-problem","title":"The Problem","text":"<p>Many IoT devices, especially affordable consumer-grade sensors, lock your data into proprietary apps and cloud platforms. This limits your ability to create custom dashboards, trigger complex automations, or ensure long-term data retention.</p>"},{"location":"#our-solution","title":"Our Solution","text":"<p>This project liberates your data by communicating directly with your Tuya device on your local network. It provides all the necessary components to collect, store, visualize, and access your water quality metrics in real-time.</p>"},{"location":"#key-features","title":"Key Features","text":"<ul> <li>Local First: No data is sent to external cloud services (after initial setup to get the <code>LocalKey</code>). Your data stays on your network.</li> <li>Full Stack Included: From firmware to database to API, everything is containerized and ready to run.</li> <li>Extensible: A clean FastAPI backend and a time-series database (InfluxDB) make it easy to integrate with other systems like Home Assistant or custom applications.</li> <li>Real-time Physical Display: Includes firmware for a LILYGO T4 ESP32 board to act as a standalone, real-time monitor.</li> <li>Open Source: The entire stack is open and ready to be customized.</li> </ul> <p>Ready to get started? Head to the Getting Started guide.</p>"},{"location":"api-reference/","title":"API Reference","text":"<p>The backend provides a RESTful API for interacting with the system. The API is automatically documented using OpenAPI and Swagger UI.</p> <p>For a live, interactive API documentation, please run the application and navigate to:</p> <p><code>http://localhost:8000/docs</code></p>"},{"location":"api-reference/#endpoints","title":"Endpoints","text":""},{"location":"api-reference/#get-latest-data","title":"Get Latest Data","text":"<ul> <li> <p>GET <code>/api/v1/data/latest</code></p> <p>Retrieves the most recent data point recorded from the water quality monitor. This is the primary endpoint used by the LILYGO hardware display.</p> <p>Response (200 OK) <code>json {   \"ph\": 7.2,   \"temperature\": 25.1,   \"tds\": 345,   \"ec\": 690,   \"timestamp\": \"2023-10-27T10:00:00Z\" }</code> If no data is available yet, it will return a model with <code>null</code> values.</p> </li> </ul>"},{"location":"api-reference/#data-models","title":"Data Models","text":""},{"location":"api-reference/#waterdata","title":"<code>WaterData</code>","text":"<p>Represents a single snapshot of water quality data.</p> Field Type Description <code>ph</code> <code>float</code> The pH level. <code>temperature</code> <code>float</code> The temperature in Celsius. <code>tds</code> <code>float</code> Total Dissolved Solids. <code>ec</code> <code>float</code> Electrical Conductivity. <code>timestamp</code> <code>string</code> The UTC timestamp of the reading."},{"location":"development/contributing/","title":"Contribution &amp; Development Guide","text":"<p>We welcome contributions to the project! This guide outlines the development process and best practices.</p>"},{"location":"development/contributing/#development-environment","title":"Development Environment","text":"<p>The easiest way to develop the backend is to run InfluxDB via Docker but run the FastAPI application on your local machine.</p> <ol> <li> <p>Start Dependencies: <code>bash     docker-compose up -d influxdb grafana</code></p> </li> <li> <p>Set up a Virtual Environment:     From the project root:     <code>bash     python -m venv venv     source venv/bin/activate</code></p> </li> <li> <p>Install Dependencies: <code>bash     pip install -r backend/requirements.txt</code></p> </li> <li> <p>Run the Development Server:     The <code>uvicorn</code> server provides live-reloading on code changes.     <code>bash     uvicorn app.main:app --reload --host 0.0.0.0 --port 8000</code> Note: You will still need a <code>.env</code> file in the <code>backend/</code> directory pointing to <code>localhost</code> for InfluxDB if running this way.</p> </li> </ol>"},{"location":"development/contributing/#running-tests","title":"Running Tests","text":"<p>The project uses <code>pytest</code> for unit testing.</p> <p>To run the test suite:</p> <pre><code># Ensure you are in your virtual environment\npytest\n</code></pre>"},{"location":"development/contributing/#code-style","title":"Code Style","text":"<p>This project does not yet enforce a strict code style with a linter, but we encourage following PEP 8 conventions.</p>"},{"location":"development/contributing/#submitting-changes","title":"Submitting Changes","text":"<ol> <li>Fork the repository on GitHub.</li> <li>Create a new branch for your feature or bugfix.</li> <li>Make your changes and commit them with clear, descriptive messages.</li> <li>Push your branch to your fork.</li> <li>Open a Pull Request against the <code>main</code> branch of the original repository.</li> </ol>"},{"location":"user-guide/architecture/","title":"Architecture","text":"<p>The Tuya Water Quality Monitor is built on a modern, containerized architecture designed for reliability and separation of concerns.</p> <p></p>"},{"location":"user-guide/architecture/#core-components","title":"Core Components","text":""},{"location":"user-guide/architecture/#1-backend-service","title":"1. Backend Service","text":"<p>The heart of the project is a FastAPI application written in Python. It serves two primary functions:</p> <ul> <li>Data Polling (Ingestion): A background scheduler (<code>APScheduler</code>) periodically invokes a service that connects to the Tuya device over the local network using the <code>tinytuya</code> library. It sends status requests and receives encrypted data payloads.</li> <li>API Server: It exposes a RESTful API for external clients. This API is used by the LILYGO T4 hardware display to fetch the latest data and can be used by any other service (like Home Assistant) for integration.</li> </ul>"},{"location":"user-guide/architecture/#2-time-series-database-influxdb","title":"2. Time-Series Database (InfluxDB)","text":"<p>We use InfluxDB v2, a leading open-source time-series database. It is purpose-built for handling timestamped data, making it extremely efficient for IoT metrics.</p> <ul> <li>Bucket: All data is stored in a dedicated bucket (default: <code>water_monitor</code>).</li> <li>Data Model: Each data point is stored with the <code>water_quality</code> measurement, a <code>device_id</code> tag, and fields for each metric (e.g., <code>ph</code>, <code>temperature</code>).</li> <li>Querying: The data is queried using the Flux query language.</li> </ul>"},{"location":"user-guide/architecture/#3-visualization-grafana","title":"3. Visualization (Grafana)","text":"<p>Grafana is the de-facto standard for creating beautiful and powerful dashboards for time-series data. It connects directly to InfluxDB as a data source. You can create panels to visualize: *   Real-time gauges for current values. *   Graphs showing trends over time. *   Alerts based on thresholds.</p>"},{"location":"user-guide/architecture/#4-hardware-display-lilygo-t4","title":"4. Hardware Display (LILYGO T4)","text":"<p>The LILYGO T4 is an ESP32-based development board with a built-in screen. The provided firmware turns it into a dedicated, low-power display for your water quality data. *   Connectivity: It connects to your local WiFi network. *   Data Fetching: Periodically, it makes an HTTP GET request to the backend's <code>/api/v1/data/latest</code> endpoint. *   Display: It parses the JSON response and renders the values on its screen.</p>"},{"location":"user-guide/architecture/#data-flow","title":"Data Flow","text":"<ol> <li>The <code>backend</code> service's scheduled job initiates a connection to the Tuya device's IP address.</li> <li>A status request is sent, encrypted with the <code>LocalKey</code>.</li> <li>The device responds with an encrypted payload containing all its sensor values (Data Points or DPS).</li> <li>The backend decrypts the payload, parses the DPS values into a structured format (e.g., <code>{\"ph\": 7.1, \"temperature\": 24.5}</code>).</li> <li>This structured data is written to the <code>water_quality</code> bucket in InfluxDB with a current timestamp.</li> <li>The LILYGO T4 display wakes up, connects to the backend API, and receives the latest data record as JSON.</li> <li>Separately, a user views a Grafana dashboard in their browser, which queries InfluxDB for historical data to render graphs.</li> </ol>"},{"location":"user-guide/architecture/#containerization-docker","title":"Containerization (Docker)","text":"<p>All server-side components (<code>backend</code>, <code>influxdb</code>, <code>grafana</code>) are defined in a single <code>docker-compose.yml</code> file. This provides: *   Isolation: Each service runs in its own container with its own dependencies. *   Reproducibility: Guarantees that the application runs the same way everywhere. *   Ease of Deployment: The entire stack can be started or stopped with a single command.</p>"},{"location":"user-guide/configuration/","title":"Configuration","text":"<p>The application is configured using environment variables. These can be set directly in your shell, but the recommended method is to place them in a <code>.env</code> file within the <code>backend/</code> directory.</p> <p>The <code>docker-compose.yml</code> file is pre-configured to load variables from this file.</p>"},{"location":"user-guide/configuration/#backend-configuration","title":"Backend Configuration","text":"<p>File: <code>backend/.env</code></p>"},{"location":"user-guide/configuration/#tuya-device-settings","title":"Tuya Device Settings","text":"<p>These are the core settings required to connect to your water quality monitor.</p> <p><code>TUYA_DEVICE_ID</code> :   Required. The unique identifier for your Tuya device. :   Example: <code>ebc123...def456</code></p> <p><code>TUYA_IP_ADDRESS</code> :   Required. The local IP address of your device. It's recommended to assign a static IP to your device via your router's DHCP settings. :   Example: <code>192.168.1.50</code></p> <p><code>TUYA_LOCAL_KEY</code> :   Required. The secret key used for local communication. :   Example: <code>a1b2c3d4e5f67890</code></p> <p><code>TUYA_VERSION</code> :   The Tuya protocol version number. :   Default: <code>3.3</code></p>"},{"location":"user-guide/configuration/#influxdb-settings","title":"InfluxDB Settings","text":"<p>These settings tell the backend how to connect to the InfluxDB database. If you are using the standard <code>docker-compose.yml</code> setup, the default values should work correctly.</p> <p><code>INFLUXDB_URL</code> :   The full URL for the InfluxDB v2 instance. :   Default: <code>http://influxdb:8086</code></p> <p><code>INFLUXDB_TOKEN</code> :   The authentication token for InfluxDB. This must match the <code>DOCKER_INFLUXDB_INIT_ADMIN_TOKEN</code> in <code>docker-compose.yml</code>. :   Default: <code>my-super-secret-auth-token</code></p> <p><code>INFLUXDB_ORG</code> :   The organization name in InfluxDB. This must match <code>DOCKER_INFLUXDB_INIT_ORG</code>. :   Default: <code>my-org</code></p> <p><code>INFLUXDB_BUCKET</code> :   The bucket where data will be stored. :   Default: <code>water_monitor</code></p>"},{"location":"user-guide/configuration/#alarming-settings-future-use","title":"Alarming Settings (Future Use)","text":"<p>These settings control the (not-yet-implemented) email alerting feature.</p> <p><code>ALARM_EMAIL_ENABLED</code> :   Enable or disable email alerts. :   Default: <code>False</code></p> <p><code>ALARM_EMAIL_RECIPIENT</code> :   The email address to send alerts to. :   Default: <code>user@example.com</code></p>"},{"location":"user-guide/getting-started/","title":"Getting Started","text":"<p>This guide provides a step-by-step walkthrough to get your Tuya Water Quality Monitor up and running.</p>"},{"location":"user-guide/getting-started/#prerequisites","title":"Prerequisites","text":"<p>Before you begin, ensure you have the following installed:</p> <ul> <li>Docker &amp; Docker Compose: For running the server-side stack (Backend, Database, Grafana).</li> <li>Git: For cloning the repository.</li> <li>Python 3.9+: For running local helper scripts.</li> <li>A Tuya-compatible Water Quality Monitor.</li> </ul>"},{"location":"user-guide/getting-started/#step-1-obtain-tuya-device-credentials","title":"Step 1: Obtain Tuya Device Credentials","text":"<p>This is the most critical step. To communicate with your device locally, you need three pieces of information:</p> <ol> <li>Device ID</li> <li>IP Address</li> <li>Local Key</li> </ol> <p>The IP Address and Device ID can be found easily using the <code>scan_tuya.py</code> script included in this project:</p> <pre><code>pip install tinytuya\npython scan_tuya.py\n</code></pre> <p>The Local Key is a secret key that the device uses to encrypt and decrypt local traffic. Obtaining it requires linking your device to a free Tuya IoT Developer Account.</p> <p>Note: The process for getting the Local Key can change. We recommend following the detailed, up-to-date guides provided by the <code>tinytuya</code> project or searching for \"get tuya local key\".</p>"},{"location":"user-guide/getting-started/#step-2-configure-the-project","title":"Step 2: Configure the Project","text":"<ol> <li> <p>Clone this repository:     <code>bash     git clone https://github.com/your-username/tuya-water-monitor.git     cd tuya-water-monitor</code></p> </li> <li> <p>Create a <code>.env</code> file inside the <code>backend/</code> directory. This file will hold your secrets.     <code>backend/.env</code></p> </li> <li> <p>Add your device credentials and database configuration to the <code>.env</code> file:     ```dotenv     # Tuya Device     TUYA_DEVICE_ID=\"YOUR_DEVICE_ID\"     TUYA_IP_ADDRESS=\"YOUR_DEVICE_IP\"     TUYA_LOCAL_KEY=\"YOUR_LOCAL_KEY\"</p> </li> </ol>"},{"location":"user-guide/getting-started/#influxdb-can-be-left-as-default-if-using-docker-compose","title":"InfluxDB (can be left as default if using docker-compose)","text":"<p>INFLUXDB_URL=\"http://influxdb:8086\" INFLUXDB_TOKEN=\"my-super-secret-auth-token\" INFLUXDB_ORG=\"my-org\" INFLUXDB_BUCKET=\"water_monitor\" ```</p>"},{"location":"user-guide/getting-started/#step-3-launch-the-stack","title":"Step 3: Launch the Stack","text":"<p>With Docker running, launch the entire application stack:</p> <pre><code>docker-compose up -d --build\n</code></pre> <p>This command will: *   Build the FastAPI backend image. *   Start the <code>backend</code>, <code>influxdb</code>, and <code>grafana</code> containers. *   The backend will automatically start polling your device.</p>"},{"location":"user-guide/getting-started/#step-4-verify-everything-is-working","title":"Step 4: Verify Everything is Working","text":"<ul> <li>API: Open your browser and navigate to <code>http://localhost:8000/docs</code>. You should see the FastAPI interactive API documentation.</li> <li>InfluxDB: Navigate to <code>http://localhost:8086</code>. You can use the credentials from <code>docker-compose.yml</code> to log in and explore the <code>water_monitor</code> bucket. You should see data points arriving.</li> <li>Grafana: Navigate to <code>http://localhost:3000</code>. Log in (default <code>admin</code>/<code>admin</code>) and configure a new InfluxDB data source to start building dashboards.</li> </ul> <p>Congratulations! Your monitoring system is now live. The next step is to set up your Hardware Display.</p>"},{"location":"user-guide/hardware/","title":"Hardware Guide: LILYGO T4 Display","text":"<p>This project includes dedicated firmware for the LILYGO T4 (an ESP32 with an integrated display) to act as a real-time, standalone monitor for your water quality data.</p>"},{"location":"user-guide/hardware/#features","title":"Features","text":"<ul> <li>Connects to your local WiFi.</li> <li>Periodically fetches the latest sensor data from the backend API.</li> <li>Displays values on the screen.</li> <li>Low power consumption.</li> </ul>"},{"location":"user-guide/hardware/#flashing-the-firmware","title":"Flashing the Firmware","text":"<p>There are two ways to get the firmware onto your device.</p>"},{"location":"user-guide/hardware/#method-1-web-flasher-recommended","title":"Method 1: Web Flasher (Recommended)Connect LILYGO T4 via USB","text":"<p>You can flash the device directly from your browser without needing to install any development tools.</p> <p>Ensure no other software (like Cura, VS Code Serial Monitor) is using the port.</p>"},{"location":"user-guide/hardware/#instructions","title":"Instructions","text":"<ol> <li>Prepare the binary: Before the flasher can be used, the project maintainer must have compiled the firmware and placed the <code>firmware.bin</code> file in the correct location (<code>docs/assets/firmware/</code>).</li> <li>Connect your device: Plug your LILYGO T4 into your computer via USB.</li> <li>Click Install: Press the \"Install\" button above. A popup will appear.</li> <li>Select the port: Choose the serial port corresponding to your device and click \"Connect\".</li> <li>The flashing process will begin automatically.</li> </ol> <p>This tool requires a modern browser like Chrome, Edge, or Opera that supports Web Serial.</p>"},{"location":"user-guide/hardware/#method-2-manual-flashing-with-platformio","title":"Method 2: Manual Flashing with PlatformIO","text":"<p>If you want to modify the firmware or compile it yourself, you'll need to use PlatformIO.</p>"},{"location":"user-guide/hardware/#prerequisites","title":"Prerequisites","text":"<ul> <li>Visual Studio Code</li> <li>PlatformIO IDE Extension for VS Code.</li> </ul>"},{"location":"user-guide/hardware/#steps","title":"Steps","text":"<ol> <li>Open the <code>firmware/</code> directory of this project in VS Code.</li> <li>PlatformIO should automatically recognize the project.</li> <li>Open <code>firmware/src/main.cpp</code>.</li> <li>Modify the configuration:<ul> <li>Update the <code>ssid</code> and <code>password</code> variables with your WiFi credentials.</li> <li>Update the <code>api_url</code> to point to the IP address of the machine running your Docker stack. For example: <code>http://192.168.1.100:8000/api/v1/data/latest</code>.</li> </ul> </li> <li>Build &amp; Upload:<ul> <li>Connect the LILYGO T4 to your computer.</li> <li>Use the PlatformIO toolbar in VS Code to build and upload the project to the device.</li> </ul> </li> </ol> <p>Your hardware display should now boot, connect to WiFi, and start showing data.</p>"},{"location":"de/","title":"Willkommen beim Tuya Wasserqualit\u00e4ts-Monitor","text":"<p>Dieses Projekt bietet eine vollst\u00e4ndige, selbst gehostete L\u00f6sung zur \u00dcberwachung der Wasserqualit\u00e4t mit g\u00e4ngigen Tuya-kompatiblen Ger\u00e4ten. Es ist robust, skalierbar und einfach zu bedienen und gibt Ihnen die volle Kontrolle \u00fcber Ihre Daten, ohne auf Cloud-Dienste von Drittanbietern angewiesen zu sein.</p> <p></p>"},{"location":"de/#das-problem","title":"Das Problem","text":"<p>Viele IoT-Ger\u00e4te, insbesondere kosteng\u00fcnstige Sensoren f\u00fcr Endverbraucher, binden Ihre Daten an propriet\u00e4re Apps und Cloud-Plattformen. Dies schr\u00e4nkt Ihre F\u00e4higkeit ein, benutzerdefinierte Dashboards zu erstellen, komplexe Automatisierungen auszul\u00f6sen oder eine langfristige Datenaufbewahrung zu gew\u00e4hrleisten.</p>"},{"location":"de/#unsere-losung","title":"Unsere L\u00f6sung","text":"<p>Dieses Projekt befreit Ihre Daten, indem es direkt mit Ihrem Tuya-Ger\u00e4t in Ihrem lokalen Netzwerk kommuniziert. Es bietet alle notwendigen Komponenten, um Ihre Wasserqualit\u00e4tsmetriken in Echtzeit zu sammeln, zu speichern, zu visualisieren und darauf zuzugreifen.</p>"},{"location":"de/#hauptmerkmale","title":"Hauptmerkmale","text":"<ul> <li>Lokal zuerst: Es werden keine Daten an externe Cloud-Dienste gesendet (nach der Ersteinrichtung zum Erhalt des <code>LocalKey</code>). Ihre Daten bleiben in Ihrem Netzwerk.</li> <li>Full-Stack inklusive: Von der Firmware \u00fcber die Datenbank bis hin zur API ist alles containerisiert und sofort einsatzbereit.</li> <li>Erweiterbar: Ein sauberes FastAPI-Backend und eine Zeitreihendatenbank (InfluxDB) machen die Integration mit anderen Systemen wie Home Assistant oder benutzerdefinierten Anwendungen einfach.</li> <li>Echtzeit-Anzeige: Enth\u00e4lt Firmware f\u00fcr ein LILYGO T4 ESP32-Board, das als eigenst\u00e4ndiger Echtzeitmonitor fungiert.</li> <li>Open Source: Der gesamte Stack ist offen und kann individuell angepasst werden.</li> </ul> <p>Bereit loszulegen? Besuchen Sie die Anleitung Erste Schritte.</p>"},{"location":"de/api-reference/","title":"API-Referenz","text":"<p>Das Backend stellt eine RESTful-API zur Interaktion mit dem System bereit. Die API wird automatisch mit OpenAPI und Swagger UI dokumentiert.</p> <p>F\u00fcr eine live, interaktive API-Dokumentation f\u00fchren Sie bitte die Anwendung aus und navigieren Sie zu:</p> <p><code>http://localhost:8000/docs</code></p>"},{"location":"de/api-reference/#endpunkte","title":"Endpunkte","text":""},{"location":"de/api-reference/#neueste-daten-abrufen","title":"Neueste Daten abrufen","text":"<ul> <li> <p>GET <code>/api/v1/data/latest</code></p> <p>Ruft den zuletzt vom Wasserqualit\u00e4tsmonitor aufgezeichneten Datenpunkt ab. Dies ist der prim\u00e4re Endpunkt, der von der LILYGO-Hardwareanzeige verwendet wird.</p> <p>Antwort (200 OK) <code>json {   \"ph\": 7.2,   \"temperature\": 25.1,   \"tds\": 345,   \"ec\": 690,   \"timestamp\": \"2023-10-27T10:00:00Z\" }</code> Wenn noch keine Daten verf\u00fcgbar sind, wird ein Modell mit <code>null</code>-Werten zur\u00fcckgegeben.</p> </li> </ul>"},{"location":"de/api-reference/#datenmodelle","title":"Datenmodelle","text":""},{"location":"de/api-reference/#waterdata","title":"<code>WaterData</code>","text":"<p>Stellt eine einzelne Momentaufnahme der Wasserqualit\u00e4tsdaten dar.</p> Feld Typ Beschreibung <code>ph</code> <code>float</code> Der pH-Wert. <code>temperature</code> <code>float</code> Die Temperatur in Celsius. <code>tds</code> <code>float</code> Gesamt gel\u00f6ste Feststoffe. <code>ec</code> <code>float</code> Elektrische Leitf\u00e4higkeit. <code>timestamp</code> <code>string</code> Der UTC-Zeitstempel der Messung."},{"location":"de/development/contributing/","title":"Leitfaden f\u00fcr Beitragende &amp; Entwicklung","text":"<p>Wir freuen uns \u00fcber Beitr\u00e4ge zum Projekt! Dieser Leitfaden beschreibt den Entwicklungsprozess und bew\u00e4hrte Verfahren.</p>"},{"location":"de/development/contributing/#entwicklungsumgebung","title":"Entwicklungsumgebung","text":"<p>Der einfachste Weg, das Backend zu entwickeln, besteht darin, InfluxDB \u00fcber Docker auszuf\u00fchren, aber die FastAPI-Anwendung auf Ihrem lokalen Rechner laufen zu lassen.</p> <ol> <li> <p>Abh\u00e4ngigkeiten starten: <code>bash     docker-compose up -d influxdb grafana</code></p> </li> <li> <p>Einrichten einer virtuellen Umgebung:     Vom Projekt-Root aus:     <code>bash     python -m venv venv     source venv/bin/activate</code></p> </li> <li> <p>Abh\u00e4ngigkeiten installieren: <code>bash     pip install -r backend/requirements.txt</code></p> </li> <li> <p>Entwicklungsserver starten:     Der <code>uvicorn</code>-Server bietet Live-Reloading bei Code-\u00c4nderungen.     <code>bash     uvicorn app.main:app --reload --host 0.0.0.0 --port 8000</code> Hinweis: Sie ben\u00f6tigen immer noch eine <code>.env</code>-Datei im <code>backend/</code>-Verzeichnis, die auf <code>localhost</code> f\u00fcr InfluxDB verweist, wenn Sie auf diese Weise arbeiten.</p> </li> </ol>"},{"location":"de/development/contributing/#tests-ausfuhren","title":"Tests ausf\u00fchren","text":"<p>Das Projekt verwendet <code>pytest</code> f\u00fcr Unit-Tests.</p> <p>So f\u00fchren Sie die Testsuite aus:</p> <pre><code># Stellen Sie sicher, dass Sie sich in Ihrer virtuellen Umgebung befinden\npytest\n</code></pre>"},{"location":"de/development/contributing/#code-stil","title":"Code-Stil","text":"<p>Dieses Projekt erzwingt noch keinen strengen Code-Stil mit einem Linter, aber wir empfehlen, die PEP 8-Konventionen zu befolgen.</p>"},{"location":"de/development/contributing/#anderungen-einreichen","title":"\u00c4nderungen einreichen","text":"<ol> <li>Forken Sie das Repository auf GitHub.</li> <li>Erstellen Sie einen neuen Branch f\u00fcr Ihr Feature oder Ihre Fehlerbehebung.</li> <li>Machen Sie Ihre \u00c4nderungen und committen Sie sie mit klaren, beschreibenden Nachrichten.</li> <li>Pushen Sie Ihren Branch zu Ihrem Fork.</li> <li>\u00d6ffnen Sie einen Pull Request gegen den <code>main</code>-Branch des urspr\u00fcnglichen Repositorys.</li> </ol>"},{"location":"de/user-guide/architecture/","title":"Architektur","text":"<p>Der Tuya Wasserqualit\u00e4ts-Monitor basiert auf einer modernen, containerisierten Architektur, die auf Zuverl\u00e4ssigkeit und Trennung der Belange ausgelegt ist.</p> <p></p>"},{"location":"de/user-guide/architecture/#kernkomponenten","title":"Kernkomponenten","text":""},{"location":"de/user-guide/architecture/#1-backend-dienst","title":"1. Backend-Dienst","text":"<p>Das Herzst\u00fcck des Projekts ist eine FastAPI-Anwendung, die in Python geschrieben ist. Sie erf\u00fcllt zwei Hauptfunktionen:</p> <ul> <li>Datenabfrage (Ingestion): Ein Hintergrund-Scheduler (<code>APScheduler</code>) ruft periodisch einen Dienst auf, der sich \u00fcber das lokale Netzwerk mit dem Tuya-Ger\u00e4t unter Verwendung der <code>tinytuya</code>-Bibliothek verbindet. Er sendet Statusanfragen und empf\u00e4ngt verschl\u00fcsselte Datennutzlasten.</li> <li>API-Server: Er stellt eine RESTful-API f\u00fcr externe Clients bereit. Diese API wird von der LILYGO T4 Hardware-Anzeige verwendet, um die neuesten Daten abzurufen, und kann von jedem anderen Dienst (wie Home Assistant) zur Integration genutzt werden.</li> </ul>"},{"location":"de/user-guide/architecture/#2-zeitreihendatenbank-influxdb","title":"2. Zeitreihendatenbank (InfluxDB)","text":"<p>Wir verwenden InfluxDB v2, eine f\u00fchrende Open-Source-Zeitreihendatenbank. Sie ist speziell f\u00fcr die Verarbeitung von zeitgestempelten Daten konzipiert, was sie f\u00fcr IoT-Metriken extrem effizient macht.</p> <ul> <li>Bucket: Alle Daten werden in einem dedizierten Bucket gespeichert (Standard: <code>water_monitor</code>).</li> <li>Datenmodell: Jeder Datenpunkt wird mit der Messung <code>water_quality</code>, einem <code>device_id</code>-Tag und Feldern f\u00fcr jede Metrik (z.B. <code>ph</code>, <code>temperatur</code>) gespeichert.</li> <li>Abfragen: Die Daten werden mit der Flux-Abfragesprache abgefragt.</li> </ul>"},{"location":"de/user-guide/architecture/#3-visualisierung-grafana","title":"3. Visualisierung (Grafana)","text":"<p>Grafana ist der De-facto-Standard zur Erstellung sch\u00f6ner und leistungsf\u00e4higer Dashboards f\u00fcr Zeitreihendaten. Es verbindet sich direkt mit InfluxDB als Datenquelle. Sie k\u00f6nnen Panels erstellen, um zu visualisieren: *   Echtzeit-Anzeigen f\u00fcr aktuelle Werte. *   Diagramme, die Trends im Zeitverlauf zeigen. *   Alarme basierend auf Schwellenwerten.</p>"},{"location":"de/user-guide/architecture/#4-hardware-anzeige-lilygo-t4","title":"4. Hardware-Anzeige (LILYGO T4)","text":"<p>Das LILYGO T4 ist ein ESP32-basiertes Entwicklungsboard mit integriertem Bildschirm. Die bereitgestellte Firmware verwandelt es in eine dedizierte, stromsparende Anzeige f\u00fcr Ihre Wasserqualit\u00e4tsdaten. *   Konnektivit\u00e4t: Es verbindet sich mit Ihrem lokalen WLAN-Netzwerk. *   Datenabruf: In regelm\u00e4\u00dfigen Abst\u00e4nden macht es eine HTTP-GET-Anfrage an den <code>/api/v1/data/latest</code>-Endpunkt des Backends. *   Anzeige: Es verarbeitet die JSON-Antwort und rendert die Werte auf seinem Bildschirm.</p>"},{"location":"de/user-guide/architecture/#datenfluss","title":"Datenfluss","text":"<ol> <li>Der geplante Job des <code>backend</code>-Dienstes initiiert eine Verbindung zur IP-Adresse des Tuya-Ger\u00e4ts.</li> <li>Eine mit dem <code>LocalKey</code> verschl\u00fcsselte Statusanfrage wird gesendet.</li> <li>Das Ger\u00e4t antwortet mit einer verschl\u00fcsselten Nutzlast, die alle seine Sensorwerte (Data Points oder DPS) enth\u00e4lt.</li> <li>Das Backend entschl\u00fcsselt die Nutzlast, verarbeitet die DPS-Werte in ein strukturiertes Format (z.B. <code>{\"ph\": 7.1, \"temperatur\": 24.5}</code>).</li> <li>Diese strukturierten Daten werden mit einem aktuellen Zeitstempel in das <code>water_quality</code>-Bucket in InfluxDB geschrieben.</li> <li>Die LILYGO T4-Anzeige wacht auf, verbindet sich mit der Backend-API und empf\u00e4ngt den neuesten Datensatz als JSON.</li> <li>Unabh\u00e4ngig davon betrachtet ein Benutzer ein Grafana-Dashboard in seinem Browser, das InfluxDB nach historischen Daten abfragt, um Diagramme zu rendern.</li> </ol>"},{"location":"de/user-guide/architecture/#containerisierung-docker","title":"Containerisierung (Docker)","text":"<p>Alle serverseitigen Komponenten (<code>backend</code>, <code>influxdb</code>, <code>grafana</code>) sind in einer einzigen <code>docker-compose.yml</code>-Datei definiert. Dies bietet: *   Isolation: Jeder Dienst l\u00e4uft in seinem eigenen Container mit seinen eigenen Abh\u00e4ngigkeiten. *   Reproduzierbarkeit: Garantiert, dass die Anwendung \u00fcberall auf die gleiche Weise l\u00e4uft. *   Einfache Bereitstellung: Der gesamte Stack kann mit einem einzigen Befehl gestartet oder gestoppt werden.</p>"},{"location":"de/user-guide/configuration/","title":"Konfiguration","text":"<p>Die Anwendung wird \u00fcber Umgebungsvariablen konfiguriert. Diese k\u00f6nnen direkt in Ihrer Shell gesetzt werden, aber die empfohlene Methode ist, sie in einer <code>.env</code>-Datei im <code>backend/</code>-Verzeichnis zu platzieren.</p> <p>Die <code>docker-compose.yml</code>-Datei ist so vorkonfiguriert, dass sie Variablen aus dieser Datei l\u00e4dt.</p>"},{"location":"de/user-guide/configuration/#backend-konfiguration","title":"Backend-Konfiguration","text":"<p>Datei: <code>backend/.env</code></p>"},{"location":"de/user-guide/configuration/#tuya-gerateeinstellungen","title":"Tuya-Ger\u00e4teeinstellungen","text":"<p>Dies sind die Kerneinstellungen, die f\u00fcr die Verbindung zu Ihrem Wasserqualit\u00e4tsmonitor erforderlich sind.</p> <p><code>TUYA_DEVICE_ID</code> :   Erforderlich. Die eindeutige Kennung f\u00fcr Ihr Tuya-Ger\u00e4t. :   Beispiel: <code>ebc123...def456</code></p> <p><code>TUYA_IP_ADDRESS</code> :   Erforderlich. Die lokale IP-Adresse Ihres Ger\u00e4ts. Es wird empfohlen, Ihrem Ger\u00e4t \u00fcber die DHCP-Einstellungen Ihres Routers eine statische IP zuzuweisen. :   Beispiel: <code>192.168.1.50</code></p> <p><code>TUYA_LOCAL_KEY</code> :   Erforderlich. Der geheime Schl\u00fcssel f\u00fcr die lokale Kommunikation. :   Beispiel: <code>a1b2c3d4e5f67890</code></p> <p><code>TUYA_VERSION</code> :   Die Tuya-Protokollversionsnummer. :   Standard: <code>3.3</code></p>"},{"location":"de/user-guide/configuration/#influxdb-einstellungen","title":"InfluxDB-Einstellungen","text":"<p>Diese Einstellungen teilen dem Backend mit, wie es sich mit der InfluxDB-Datenbank verbinden soll. Wenn Sie das Standard-<code>docker-compose.yml</code>-Setup verwenden, sollten die Standardwerte korrekt funktionieren.</p> <p><code>INFLUXDB_URL</code> :   Die vollst\u00e4ndige URL f\u00fcr die InfluxDB v2-Instanz. :   Standard: <code>http://influxdb:8086</code></p> <p><code>INFLUXDB_TOKEN</code> :   Das Authentifizierungstoken f\u00fcr InfluxDB. Dieses muss mit dem <code>DOCKER_INFLUXDB_INIT_ADMIN_TOKEN</code> in <code>docker-compose.yml</code> \u00fcbereinstimmen. :   Standard: <code>my-super-secret-auth-token</code></p> <p><code>INFLUXDB_ORG</code> :   Der Organisationsname in InfluxDB. Dieser muss mit <code>DOCKER_INFLUXDB_INIT_ORG</code> \u00fcbereinstimmen. :   Standard: <code>my-org</code></p> <p><code>INFLUXDB_BUCKET</code> :   Der Bucket, in dem die Daten gespeichert werden. :   Standard: <code>water_monitor</code></p>"},{"location":"de/user-guide/configuration/#alarmeinstellungen-zukunftige-verwendung","title":"Alarmeinstellungen (Zuk\u00fcnftige Verwendung)","text":"<p>Diese Einstellungen steuern die (noch nicht implementierte) E-Mail-Alarmierungsfunktion.</p> <p><code>ALARM_EMAIL_ENABLED</code> :   Aktivieren oder deaktivieren Sie E-Mail-Alarme. :   Standard: <code>False</code></p> <p><code>ALARM_EMAIL_RECIPIENT</code> :   Die E-Mail-Adresse, an die Alarme gesendet werden sollen. :   Standard: <code>user@example.com</code></p>"},{"location":"de/user-guide/getting-started/","title":"Erste Schritte","text":"<p>Diese Anleitung bietet eine schrittweise Beschreibung, um Ihren Tuya Wasserqualit\u00e4ts-Monitor in Betrieb zu nehmen.</p>"},{"location":"de/user-guide/getting-started/#voraussetzungen","title":"Voraussetzungen","text":"<p>Stellen Sie vor Beginn sicher, dass Sie Folgendes installiert haben:</p> <ul> <li>Docker &amp; Docker Compose: Zum Ausf\u00fchren des serverseitigen Stacks (Backend, Datenbank, Grafana).</li> <li>Git: Zum Klonen des Repositorys.</li> <li>Python 3.9+: Zum Ausf\u00fchren lokaler Hilfsskripte.</li> <li>Ein Tuya-kompatibler Wasserqualit\u00e4tsmonitor.</li> </ul>"},{"location":"de/user-guide/getting-started/#schritt-1-tuya-gerateanmeldeinformationen-abrufen","title":"Schritt 1: Tuya-Ger\u00e4teanmeldeinformationen abrufen","text":"<p>Dies ist der kritischste Schritt. Um lokal mit Ihrem Ger\u00e4t zu kommunizieren, ben\u00f6tigen Sie drei Informationen:</p> <ol> <li>Ger\u00e4te-ID (Device ID)</li> <li>IP-Adresse</li> <li>Lokaler Schl\u00fcssel (Local Key)</li> </ol> <p>Die IP-Adresse und die Ger\u00e4te-ID k\u00f6nnen einfach mit dem im Projekt enthaltenen Skript <code>scan_tuya.py</code> gefunden werden:</p> <pre><code>pip install tinytuya\npython scan_tuya.py\n</code></pre> <p>Der Local Key ist ein geheimer Schl\u00fcssel, den das Ger\u00e4t zur Ver- und Entschl\u00fcsselung des lokalen Datenverkehrs verwendet. Um ihn zu erhalten, m\u00fcssen Sie Ihr Ger\u00e4t mit einem kostenlosen Tuya IoT-Entwicklerkonto verkn\u00fcpfen.</p> <p>Hinweis: Der Prozess zum Erhalt des Local Key kann sich \u00e4ndern. Wir empfehlen, den detaillierten, aktuellen Anleitungen des <code>tinytuya</code>-Projekts zu folgen oder nach \"get tuya local key\" zu suchen.</p>"},{"location":"de/user-guide/getting-started/#schritt-2-projekt-konfigurieren","title":"Schritt 2: Projekt konfigurieren","text":"<ol> <li> <p>Klonen Sie dieses Repository:     <code>bash     git clone https://github.com/ihr-benutzername/tuya-water-monitor.git     cd tuya-water-monitor</code></p> </li> <li> <p>Erstellen Sie eine <code>.env</code>-Datei im <code>backend/</code>-Verzeichnis. Diese Datei wird Ihre Geheimnisse enthalten.     <code>backend/.env</code></p> </li> <li> <p>F\u00fcgen Sie Ihre Ger\u00e4teanmeldeinformationen und Datenbankkonfiguration zur <code>.env</code>-Datei hinzu:     ```dotenv     # Tuya Ger\u00e4t     TUYA_DEVICE_ID=\"IHRE_GER\u00c4TE_ID\"     TUYA_IP_ADDRESS=\"IHRE_GER\u00c4TE_IP\"     TUYA_LOCAL_KEY=\"IHR_LOCAL_KEY\"</p> </li> </ol>"},{"location":"de/user-guide/getting-started/#influxdb-kann-als-standard-belassen-werden-wenn-docker-compose-verwendet-wird","title":"InfluxDB (kann als Standard belassen werden, wenn docker-compose verwendet wird)","text":"<p>INFLUXDB_URL=\"http://influxdb:8086\" INFLUXDB_TOKEN=\"my-super-secret-auth-token\" INFLUXDB_ORG=\"my-org\" INFLUXDB_BUCKET=\"water_monitor\" ```</p>"},{"location":"de/user-guide/getting-started/#schritt-3-den-stack-starten","title":"Schritt 3: Den Stack starten","text":"<p>Starten Sie bei laufendem Docker den gesamten Anwendungsstack:</p> <pre><code>docker-compose up -d --build\n</code></pre> <p>Dieser Befehl wird: *   Das FastAPI-Backend-Image erstellen. *   Die Container <code>backend</code>, <code>influxdb</code> und <code>grafana</code> starten. *   Das Backend beginnt automatisch, Ihr Ger\u00e4t abzufragen.</p>"},{"location":"de/user-guide/getting-started/#schritt-4-uberprufen-ob-alles-funktioniert","title":"Schritt 4: \u00dcberpr\u00fcfen, ob alles funktioniert","text":"<ul> <li>API: \u00d6ffnen Sie Ihren Browser und navigieren Sie zu <code>http://localhost:8000/docs</code>. Sie sollten die interaktive API-Dokumentation von FastAPI sehen.</li> <li>InfluxDB: Navigieren Sie zu <code>http://localhost:8086</code>. Sie k\u00f6nnen die Anmeldeinformationen aus der <code>docker-compose.yml</code> verwenden, um sich anzumelden und das <code>water_monitor</code>-Bucket zu erkunden. Sie sollten ankommende Datenpunkte sehen.</li> <li>Grafana: Navigieren Sie zu <code>http://localhost:3000</code>. Melden Sie sich an (Standard <code>admin</code>/<code>admin</code>) und konfigurieren Sie eine neue InfluxDB-Datenquelle, um Dashboards zu erstellen.</li> </ul> <p>Herzlichen Gl\u00fcckwunsch! Ihr \u00dcberwachungssystem ist jetzt live. Der n\u00e4chste Schritt ist die Einrichtung Ihres Hardware-Displays.</p>"},{"location":"de/user-guide/hardware/","title":"Hardware-Anleitung: LILYGO T4 Display","text":"<p>Dieses Projekt enth\u00e4lt eine dedizierte Firmware f\u00fcr das LILYGO T4 (ein ESP32 mit integriertem Display), um als eigenst\u00e4ndiger Echtzeit-Monitor f\u00fcr Ihre Wasserqualit\u00e4tsdaten zu fungieren.</p>"},{"location":"de/user-guide/hardware/#merkmale","title":"Merkmale","text":"<ul> <li>Verbindet sich mit Ihrem lokalen WLAN.</li> <li>Ruft regelm\u00e4\u00dfig die neuesten Sensordaten von der Backend-API ab.</li> <li>Zeigt Werte auf dem Bildschirm an.</li> <li>Geringer Stromverbrauch.</li> </ul>"},{"location":"de/user-guide/hardware/#flashen-der-firmware","title":"Flashen der Firmware","text":"<p>Es gibt zwei M\u00f6glichkeiten, die Firmware auf Ihr Ger\u00e4t zu bringen.</p>"},{"location":"de/user-guide/hardware/#methode-1-web-flasher-empfohlen","title":"Methode 1: Web-Flasher (Empfohlen)LILYGO T4 via USB verbinden","text":"<p>Sie k\u00f6nnen das Ger\u00e4t direkt von Ihrem Browser aus flashen, ohne Entwicklungstools installieren zu m\u00fcssen.</p> <p>Stellen Sie sicher, dass keine andere Software (wie Cura oder VS Code) den Port blockiert.</p>"},{"location":"de/user-guide/hardware/#anleitung","title":"Anleitung","text":"<ol> <li>Binary vorbereiten: Bevor der Flasher verwendet werden kann, muss der Projektbetreuer die Firmware kompiliert und die Datei <code>firmware.bin</code> am richtigen Ort (<code>docs/assets/firmware/</code>) platziert haben.</li> <li>Ger\u00e4t verbinden: Stecken Sie Ihr LILYGO T4 \u00fcber USB an Ihren Computer an.</li> <li>Auf \"Install\" klicken: Dr\u00fccken Sie die \"Install\"-Schaltfl\u00e4che oben. Ein Popup wird erscheinen.</li> <li>Port ausw\u00e4hlen: W\u00e4hlen Sie den seriellen Port, der Ihrem Ger\u00e4t entspricht, und klicken Sie auf \"Verbinden\".</li> <li>Der Flash-Vorgang beginnt automatisch.</li> </ol> <p>Dieses Tool erfordert einen modernen Browser wie Chrome, Edge oder Opera, der Web Serial unterst\u00fctzt.</p>"},{"location":"de/user-guide/hardware/#methode-2-manuelles-flashen-mit-platformio","title":"Methode 2: Manuelles Flashen mit PlatformIO","text":"<p>Wenn Sie die Firmware \u00e4ndern oder selbst kompilieren m\u00f6chten, m\u00fcssen Sie PlatformIO verwenden.</p>"},{"location":"de/user-guide/hardware/#voraussetzungen","title":"Voraussetzungen","text":"<ul> <li>Visual Studio Code</li> <li>PlatformIO IDE Extension f\u00fcr VS Code.</li> </ul>"},{"location":"de/user-guide/hardware/#schritte","title":"Schritte","text":"<ol> <li>\u00d6ffnen Sie das <code>firmware/</code>-Verzeichnis dieses Projekts in VS Code.</li> <li>PlatformIO sollte das Projekt automatisch erkennen.</li> <li>\u00d6ffnen Sie <code>firmware/src/main.cpp</code>.</li> <li>Konfiguration \u00e4ndern:<ul> <li>Aktualisieren Sie die Variablen <code>ssid</code> und <code>password</code> mit Ihren WLAN-Anmeldeinformationen.</li> <li>Aktualisieren Sie die <code>api_url</code>, sodass sie auf die IP-Adresse des Computers verweist, auf dem Ihr Docker-Stack l\u00e4uft. Zum Beispiel: <code>http://192.168.1.100:8000/api/v1/data/latest</code>.</li> </ul> </li> <li>Kompilieren &amp; Hochladen:<ul> <li>Verbinden Sie das LILYGO T4 mit Ihrem Computer.</li> <li>Verwenden Sie die PlatformIO-Symbolleiste in VS Code, um das Projekt zu kompilieren und auf das Ger\u00e4t hochzuladen.</li> </ul> </li> </ol> <p>Ihr Hardware-Display sollte nun starten, sich mit dem WLAN verbinden und Daten anzeigen.</p>"}]}